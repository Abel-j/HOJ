{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{360:function(s,a,n){\"use strict\";n.r(a);var t=n(41),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[n(\"h1\",{attrs:{id:\"评测数据同步\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#评测数据同步\"}},[s._v(\"#\")]),s._v(\" 评测数据同步\")]),s._v(\" \"),n(\"h2\",{attrs:{id:\"一、常规部署\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#一、常规部署\"}},[s._v(\"#\")]),s._v(\" 一、常规部署\")]),s._v(\" \"),n(\"ol\",[n(\"li\",[n(\"p\",[s._v(\"在主后台服务开启rsync实现服务增量同步，本HOJ使用子服务器主动拉取最新评测数据的功能（可选择主服务推的功能，但对主服务器的功耗较大）\")])]),s._v(\" \"),n(\"li\",[n(\"p\",[s._v(\"首先在主服务器（运行后端服务）的服务器中配置，指令如下\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"vim\")]),s._v(\" /etc/rsyncd/rsyncd.conf \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 新建配置文件\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\")])]),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 将以下内容写入的rsyncd.conf文件里面 然后保存退出\")]),s._v(\"\\nport \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"873\")]),s._v(\"\\nuid \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" root\\ngid \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" root\\nuse \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chroot\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"yes\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"read\")]),s._v(\" only \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"yes\")]),s._v(\"\\nlog \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"file\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" /hoj/log/rsyncd.log\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"testcase\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\npath \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" /hoj/testcase/\\nlist \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"yes\")]),s._v(\"\\nauth \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"users\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" hojrsync\\nsecrets \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"file\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" /etc/rsyncd/rsyncd.passwd\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),n(\"br\")])]),n(\"p\",[s._v(\"再新建密码配置文件\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"vim\")]),s._v(\" /etc/rsyncd/rsyncd.passwd\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\")])]),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 将以下内容写入rsyncd.passwd文件里面，冒号后面的密码可用自定义，然后保存退出。\")]),s._v(\"\\nhojrsync:123456\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\")])]),n(\"p\",[s._v(\"修改密码配置文件的权限为600\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chmod\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"600\")]),s._v(\" /etc/rsyncd/rsyncd.passwd\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\")])]),n(\"p\",[s._v(\"然后使用命令，使用后台守护进程运行rsync\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rsync\")]),s._v(\" --daemon --config\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"/etc/rsyncd/rsyncd.conf\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\")])]),n(\"p\",[s._v(\"设置开启自启动\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"echo\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"/usr/bin/rsync --daemon --config=/etc/rsyncd/rsyncd.conf\"')]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">>\")]),s._v(\" /etc/rc.local\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\")])])]),s._v(\" \"),n(\"li\",[n(\"p\",[s._v(\"之后在运行JudgeServer判题服务的服务器上使用rsync每60秒同步一次指定文件夹的评测数据（同步周期可自己改）\")]),s._v(\" \"),n(\"p\",[s._v(\"新建密码配置文件，同时写入与主服务端的rsync一样的密码\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"vim\")]),s._v(\" /etc/rsyncd/rsyncd.passwd\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\")])]),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"123456\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 保存退出\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\")])]),n(\"p\",[s._v(\"修改密码配置文件的权限为600\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chmod\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"600\")]),s._v(\" /etc/rsyncd/rsyncd.passwd\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\")])]),n(\"p\",[s._v(\"然后编写sh文件\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"vim\")]),s._v(\" /etc/rsyncd/rsyncd_slave.sh\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\")])]),n(\"p\",[s._v(\"注意${ip}写自己主服务器的ip\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"while\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token boolean\"}},[s._v(\"true\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"do\")]),s._v(\"\\n       \\t\"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rsync\")]),s._v(\" -avz --delete --progress --password-file\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"/etc/rsyncd/rsyncd.passwd hojrsync@\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${ip}\")]),s._v(\"::testcase /hoj/testcase \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">>\")]),s._v(\" /hoj/log/rsync_slave.log\\n       \\t\"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sleep\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"60\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"done\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\")])]),n(\"p\",[s._v(\"使用 nohup后台运行即可\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"nohup\")]),s._v(\" /etc/rsyncd/rsyncd_slave.sh \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\")])])])]),s._v(\" \"),n(\"h2\",{attrs:{id:\"二、docker部署\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#二、docker部署\"}},[s._v(\"#\")]),s._v(\" 二、docker部署\")]),s._v(\" \"),n(\"h3\",{attrs:{id:\"前言\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#前言\"}},[s._v(\"#\")]),s._v(\" 前言\")]),s._v(\" \"),n(\"p\",[s._v(\"直接下载部署项目，进入到当前文件夹执行打包命令\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"git\")]),s._v(\" clone https://gitee.com/himitzh0730/hoj-deploy.git \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"&&\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"cd\")]),s._v(\" hoj-deploy/src/rsync\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\")])]),n(\"p\",[s._v(\"当前文件夹为打包\"),n(\"code\",[s._v(\"hoj-rsync\")]),s._v(\"镜像的相关文件，将这些文件复制到同一个文件夹内，之后执行以下命令进行打包成镜像.\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[s._v(\"docker build -t hoj-rsync \"),n(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\".\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\")])]),n(\"p\",[n(\"strong\",[s._v(\"该服务用于测试用例数据在不同服务器之间的同步\")])]),s._v(\" \"),n(\"p\",[s._v(\"docker run启动\")]),s._v(\" \"),n(\"ul\",[n(\"li\",[n(\"p\",[s._v(\"主服务器（Backend所在服务器）\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[s._v(\"docker run -d --name hoj-rsync \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n-v ./hoj/testcase:/hoj/testcase:ro \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n-e \"),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"RSYNC_MODE\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"master \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n-e \"),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"RSYNC_USER\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"hojrsync \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n-e \"),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"RSYNC_PASSWORD\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"hoj123456 \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n-p \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"873\")]),s._v(\":873 \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n--restart\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"always \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\nhoj-rsync\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# registry.cn-shenzhen.aliyuncs.com/hcode/hoj_rsync:1.0\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\")])])]),s._v(\" \"),n(\"li\",[n(\"p\",[s._v(\"从服务器（Judgeserver所在的服务器）\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[s._v(\"docker run -d --name hoj-rsync \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n-v ./hoj/testcase:/hoj/testcase \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n-e \"),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"RSYNC_MODE\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"slave \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n-e \"),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"RSYNC_USER\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"hojrsync \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n-e \"),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"RSYNC_PASSWORD\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"hoj123456 \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n-e \"),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"RSYNC_MASTER_ADDR\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"master_server_ip \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n-p \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"873\")]),s._v(\":873 \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\n--restart\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"always \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"\\nhoj-rsync\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# registry.cn-shenzhen.aliyuncs.com/hcode/hoj_rsync:1.0\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\")])])])]),s._v(\" \"),n(\"p\",[s._v(\"docker-compose启动\")]),s._v(\" \"),n(\"ul\",[n(\"li\",[n(\"p\",[s._v(\"主服务器（Backend所在服务器）\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-yaml line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-yaml\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"version\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"3\"')]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"services\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n  \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"hoj-rsync-master\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#    image: registry.cn-shenzhen.aliyuncs.com/hcode/hoj_rsync:1.0\")]),s._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"image\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" hoj\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\"rsync\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"container_name\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" hoj\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\"rsync\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\"master\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"volumes\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\" ./hoj/testcase\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"/hoj/testcase\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"ro\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"environment\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\" RSYNC_MODE=master \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 当前为slave主服务\")]),s._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\" RSYNC_USER=hojrsync \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 请勿修改\")]),s._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\" RSYNC_PASSWORD=hoj123456 \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 请修改数据同步密码\")]),s._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"ports\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"0.0.0.0:873:873\"')]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),n(\"br\")])])]),s._v(\" \"),n(\"li\",[n(\"p\",[s._v(\"从服务器（Judgeserver所在的服务器）\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-yaml line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-yaml\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"version\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"3\"')]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"services\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n  \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"hoj-rsync-slave\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#    image: registry.cn-shenzhen.aliyuncs.com/hcode/hoj_rsync:1.0\")]),s._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"image\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" hoj\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\"rsync\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"container_name\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" hoj\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\"rsync\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\"slave\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"restart\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" always\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"volumes\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\" ./judge/test_case\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"/hoj/testcase\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\" ./judge/log\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"/hoj/log\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"environment\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\" RSYNC_MODE=slave \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 当前为slave从服务\")]),s._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\" RSYNC_USER=hojrsync \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 请勿修改\")]),s._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\" RSYNC_PASSWORD=hoj123456 \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 与主服务器的rsync的密码一致\")]),s._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\" RSYNC_MASTER_ADDR=master_server_ip \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 主服务器ip\")]),s._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[s._v(\"ports\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"0.0.0.0:873:873\"')]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),n(\"br\")])])])]),s._v(\" \"),n(\"p\",[s._v(\"###文件介绍\")]),s._v(\" \"),n(\"h4\",{attrs:{id:\"_1-rsync-conf\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-rsync-conf\"}},[s._v(\"#\")]),s._v(\" 1. rsync.conf\")]),s._v(\" \"),n(\"p\",[s._v(\"主服务器的rsync配置文件\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-shell line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[s._v(\"port \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"873\")]),s._v(\"\\nuid \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" root\\ngid \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" root\\nuse \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chroot\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"yes\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"read\")]),s._v(\" only \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"yes\")]),s._v(\"\\nlog \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"file\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" /hoj/log/rsyncd.log\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"testcase\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\npath \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" /hoj/testcase/\\nlist \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"yes\")]),s._v(\"\\nauth \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"users\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" hojrsync\\nsecrets \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"file\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" /hoj/rsyncd/rsyncd.passwd\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\")])]),n(\"h4\",{attrs:{id:\"_2-run-sh\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-run-sh\"}},[s._v(\"#\")]),s._v(\" 2. run.sh\")]),s._v(\" \"),n(\"p\",[s._v(\"根据\"),n(\"code\",[s._v(\"$RSYNC_MODE\")]),s._v(\"环境变量启动不同模式的rsync服务\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token shebang important\"}},[s._v(\"#!/usr/bin/bash\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"if\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"'),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$RSYNC_MODE\")]),s._v('\"')]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"==\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"master\"')]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"then\")]),s._v(\"\\n\\t\"),n(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"echo\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"'),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$RSYNC_USER\")]),s._v(\":\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$RSYNC_PASSWORD\")]),s._v('\"')]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" /hoj/rsyncd/rsyncd_master.passwd\\n\\t\"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chmod\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"600\")]),s._v(\" /hoj/rsyncd/rsyncd_master.passwd\\n\\t\"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rsync\")]),s._v(\" --daemon --config\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"/hoj/rsyncd/rsyncd.conf\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"else\")]),s._v(\"\\n\\t\"),n(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"echo\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"'),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$RSYNC_PASSWORD\")]),s._v('\"')]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" /hoj/rsyncd/rsyncd_slave.passwd\\n\\t\"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chmod\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"600\")]),s._v(\" /hoj/rsyncd/rsyncd_slave.passwd\\n\\t\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"while\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token boolean\"}},[s._v(\"true\")]),s._v(\"\\n\\t\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"do\")]),s._v(\"\\n\\t\\t\"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rsync\")]),s._v(\" -avz --delete --progress --password-file\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"/hoj/rsyncd/rsyncd_slave.passwd \"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$RSYNC_USER\")]),s._v(\"@\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$RSYNC_MASTER_ADDR\")]),s._v(\"::testcase /hoj/testcase \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">>\")]),s._v(\" /hoj/log/rsync_slave.log\\n\\t\\t\"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sleep\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"100\")]),s._v(\"\\n\\t\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"done\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"fi\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),n(\"br\")])]),n(\"h4\",{attrs:{id:\"_3-dockerfile\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-dockerfile\"}},[s._v(\"#\")]),s._v(\" 3. Dockerfile\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-dockerfile line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-dockerfile\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"FROM\")]),s._v(\" ubuntu\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\"18.04\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"RUN\")]),s._v(\" apt\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\"get update && apt\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\"get \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\"y install rsync\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"RUN\")]),s._v(\" mkdir \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"-\")]),s._v(\"p /hoj/rsyncd\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"COPY\")]),s._v(\" run.sh /hoj/rsyncd/run.sh\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"COPY\")]),s._v(\" rsyncd.conf /hoj/rsyncd/rsyncd.conf\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"CMD\")]),s._v(\" /bin/bash /hoj/rsyncd/run.sh\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\")])])])}),[],!1,null,null,null);a.default=e.exports}}]);","extractedComments":[]}